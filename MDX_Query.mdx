-- câu 1: Thống kê doanh thu bán hàng theo từng năm tại nước Đức
With member [Measures].[Doanh thu] 
as [Measures].[Sales] ,FORMAT_STRING = 'Currency'

Select {[Measures].[Doanh thu]} on Columns , 
{[DIM DATE].[Ship Year].Members} on Rows
From [Super Store DW]
Where [DIM LOCATION].[Country].&[Germany];

-- câu2: Cho biết thông tin khách hàng (tên khách hàng, loại khách hàng) doanh thu cao nhất trong quý 2 năm 2012
With member [Measures].[Doanh thu] 
as [Measures].[Sales] ,FORMAT_STRING = 'Currency'

Select {[Measures].[Doanh thu]} on Columns , 
{TopCount({[DIM CUSTOMER].[Customer ID].CHILDREN*[DIM CUSTOMER].[Segment].Children*[DIM CUSTOMER].[Customer Name].Children},1,[Measures].[Sales])} on Rows
From [Super Store DW]
Where [DIM DATE].[PhanCapTheoGiaoHang].[Ship Quater].&[Q2]&[2.012E3]; 

-- câu 3:	Cho biết tên khách hàng có tổng số lượng sản phẩm đã mua trên 5 tại bang Texas.
Select	{[Measures].[Quantity]} on Columns , 
		{Filter
			( {[DIM CUSTOMER].[Customer Name].Children*[DIM CUSTOMER].[Customer ID].CHILDREN}
			, [Measures].[Quantity] > 5
			)
		} on Rows
From [Super Store DW]
Where [DIM LOCATION].[State].&[Texas]&[United States]&[US]&[Central];


-- câu 4: Đưa ra phần trăm về phí vận chuyển của từng từng thị trường (Market) trong năm 2013.
With Member [Measures].[shipping Percent]
	As ([Measures].[Shipping Cost]) 
	/ Sum
		([DIM LOCATION].[Market].CurrentMember.Parent
		, [Measures].[Shipping Cost]
		)
	, Format_String = 'Percent'
Select	{[Measures].[Shipping Percent]} on Columns,
		{[DIM LOCATION].[Market].Children} on Rows
From [Super Store DW]
Where [DIM DATE].[Ship Year].&[2.013E3];

--- câu 5: 11.5	Theo từng tháng, quý, năm liệt kê loại hình vận chuyển cùng với phí vận chuyển của loại hình đó (nếu có).
 Select	{[DIM SHIPMODE].[Ship Mode].Children *[Measures].[Shipping Cost]} on Columns,
		{	
			DrillDownLevel(
				DrillDownLevel(
					DrillDownLevel(
					[DIM DATE].[PhanCapTheoDatHang])
				)
			)
		} on Rows
 From [Super Store DW];
 
 -- Câu 6: Cho biết tên sản phẩm, loại sản phẩm và tổng số lượng sản phẩm đó lớn hơn 10 được đặt theo từng quốc gia. 
 Select	{[Measures].[Quantity]} on Columns,
		{Generate(
			[DIM LOCATION].[Country].Children, 
			[DIM LOCATION].[Country].CurrentMember *
			Filter(
				{[DIM PRODUCT].[Product Name].Children
				*[DIM PRODUCT].[Category].Children},
				[Measures].[Quantity] > 10
				)
			)
		} on Rows
From	[Super Store DW];

-- Câu 7: Với từng thành phố liệt kê số lượng chi tiết hóa đơn bán ra theo từng năm trừ thành phố Zurich và Zhuhai.
Select	{[DIM DATE].[Ship Year].Members} on Columns,
		{Except(
			{[DIM LOCATION].[City].Children},
			{[DIM LOCATION].[City].&[Zhuhai]&[Guangdong]&[China]&[APAC]&[North Asia],
			[DIM LOCATION].[City].&[Zurich]&[Zürich]&[Switzerland]&[EU]&[Central]}
			)
		} on Rows
From	[Super Store DW]
Where	{[Measures].[FACT SUPERSTORE Count]};

-- Câu 8: Đưa ra TOP 3 sản phẩm có lợi nhuận nhiều nhất trong năm 2013
Select	{[Measures].[Profit]} on Columns,
		{TopCount(
			{[DIM PRODUCT].[Product Name].Children},
			3,
			[Measures].[Profit]
			)
		} on Rows
From	[Super Store DW]
Where	{[DIM DATE].[Ship Year].&[2.013E3]};

--- Câu 9 Thống kê lợi nhuận, doanh thu, và phần trăm lợi nhuận từng loại sản phẩm, sắp xếp theo thứ tự phần trăm lợi nhuận giảm dần.
With Member [Measures].[Profit Percent]
	 As [Measures].[Profit] / [Measures].[Sales]
	 ,Format_String = 'Percent'
Select	{[Measures].[Profit],[Measures].[Sales],[Measures].[Profit Percent]} on Columns,
		{	Order(
				[DIM PRODUCT].[Category].Children,
				[Measures].[Profit Percent],
				DESC
			)
		} on Rows
From	[Super Store DW];

-- Câu 10: Cho biết khách hàng có số lần mua hàng cao nhất và khách hàng có số lần mua hàng thấp nhất
Select	{[Measures].[FACT SUPERSTORE Count]} on Columns,
		{Union(
			TopCount({[DIM CUSTOMER].[Customer ID].Children*[DIM CUSTOMER].[Customer Name].Children},1,[Measures].[FACT SUPERSTORE Count]),
			BottomCount({[DIM CUSTOMER].[Customer ID].Children*[DIM CUSTOMER].[Customer Name].Children},1,[Measures].[FACT SUPERSTORE Count])
			)
		} on Rows
From	[Super Store DW];

-- Câu 11: Liệt kê những sản phẩm (ID) có tổng doanh thu từ $1000 đến $10000

Select	{[Measures].[Sales]} on Columns,
		
			{Intersect( 
				{Filter([DIM PRODUCT].[Product ID].Children , [Measures].[Sales] >= 1000)}
				,{Filter([DIM PRODUCT].[Product ID].Children , [Measures].[Sales] <= 10000)}
			)}
			
		on Rows
From	[Super Store DW];

--- Câu 12: Đưa ra doanh thu, lợi nhuận, số lượng sản phẩm bán ra của từng tiểu mục sản phẩm (Sub-Category).
Select	{[Measures].[Sales], [Measures].[Profit], [Measures].[Quantity]} on Columns,
		{[DIM PRODUCT].[Sub- Category].Children} on Rows
From	[Super Store DW];

--- Câu 13: Với mỗi quốc gia đưa ra 3 thành phố có lợi nhuận cao nhất.
Select	{[Measures].[Profit]} on Columns,
		{Generate(
			[DIM LOCATION].[Country].Children,
			TopCount( 
				{[DIM LOCATION].[Country].CurrentMember * [DIM LOCATION].[City].Children}
				,3
				,[Measures].[Profit]
			)
		)} on Rows
From	[Super Store DW];

--- Câu 14: Đưa ra 3 sản phẩm có số lượng mua hàng ít nhất tại New Zealand.
Select	{[Measures].[Quantity]} on Columns,
		{BottomCount(
			NonEmpty(
				[DIM PRODUCT].[Product Name].Children
				,[Measures].[Quantity]
			)
			,3
			,[Measures].[Quantity]
		)} on Rows
From	[Super Store DW]
Where	[DIM LOCATION].[Country].&[New Zealand]&[APAC]&[Oceania];

---- Câu 15: 	Liệt kê những sản phẩm thuộc top 5 soanh thu cao nhất hoặc top 3 số lượng bán cao nhất. 
Select	{[Measures].[Sales],[Measures].[Quantity]} on Columns,
		{Union(
			TopCount(
				{[DIM PRODUCT].[Product ID].Children * [DIM PRODUCT].[Product Name].Children}
				,5
				,[Measures].[Sales]
			)
			,TopCount(
					{[DIM PRODUCT].[Product ID].Children * [DIM PRODUCT].[Product Name].Children}
					,3
					,[Measures].[Quantity]
			)
		)} 
		on Rows
From	[Super Store DW];